# 트래킹 로그 정합성 검증 — 작업내용 보고·기록 위키

작업 내역, 규칙, 진행 영역, 결과 기록 방식을 정리한 보고·기록용 문서입니다. 프로젝트 저장소에 접근할 수 없어도 이 문서만으로 이해할 수 있도록 핵심 내용을 요약해 두었습니다.

---

## 목차

1. [개요](#1-개요)
2. [BDD 형식 변환 및 파라미터라이즈](#2-bdd-형식-변환-및-파라미터라이즈)
3. [정합성 형식 (Skip / Mandatory / List)](#3-정합성-형식-skip--mandatory--list)
4. [결과 기록 방식 (Pass / Fail 구분)](#4-결과-기록-방식-pass--fail-구분)
5. [진행 영역](#5-진행-영역)
6. [필드 관리 (구글 시트, 공통 필드)](#6-필드-관리-구글-시트-공통-필드)

---

## 1. 개요

| 항목 | 설명 |
|------|------|
| **프로젝트 목적** | G마켓 트래킹 로그의 정합성을 자동으로 검증한다. (검색/리스트/장바구니/주문완료 등 페이지에서 발생하는 이벤트 로그가 기대값과 일치하는지 검증.) |
| **이 문서의 목적** | 작업 내역·검증 규칙·진행 영역·결과 기록 방식을 한곳에 정리하여, 담당자·리뷰어가 “무엇을 어떻게 했는지” 빠르게 파악할 수 있게 한다. |

---

## 2. BDD 형식 변환 및 파라미터라이즈

- **BDD 형식**: 시나리오를 Gherkin 문법으로 작성한다. Feature → Scenario, Given(조건) / When(행동) / Then(검증) 구조를 사용한다.
- **유사 동작 영역에 파라미터라이즈 적용**: 같은 플로우를 반복하는 경우, 시나리오를 여러 번 복사하지 않고 **Scenario Outline**과 **Examples** 테이블을 사용해 한 번만 작성한다.
  - **SRP(검색 결과 페이지)**: 검색어(`keyword`), 모듈명(`module_title`), TestRail TC ID(`tc_module_exposure`, `tc_product_exposure`, `tc_product_click`, `tc_atc_click` 등)를 Examples 테이블에 넣어 모듈별·키워드별로 한 시나리오로 실행한다.
  - **LP(리스트 페이지)**: 카테고리 ID(`category_id`), 모듈명(`module_title`), TC ID를 Examples로 넣어 동일하게 관리한다.
- 이렇게 하면 모듈이 늘어나도 시나리오는 그대로 두고 Examples 행만 추가하면 된다.

---

## 3. 정합성 형식 (Skip / Mandatory / List)

검증 시 각 필드에 대해 아래 세 가지 방식 중 하나가 적용된다.

| 형식 | 의미 | 동작 |
|------|------|------|
| **skip** | 해당 필드는 검증하지 않음 | 설정에 `"skip"`으로 두거나, 해당 이벤트 타입이 모듈 설정에 없으면 그 이벤트 검증 자체를 스킵한다. |
| **mandatory** | 필수 필드 | 반드시 값이 있어야 한다. 값이 없거나 빈 문자열이면 정합성 검증 실패로 처리한다. |
| **list** | 허용 값 목록(배열) | 실제 값이 목록에 있는 값 중 하나와 일치하면 통과(OR 조건). 예: `["Y", "N"]`이면 실제가 "Y" 또는 "N"이면 통과. |

---

## 4. 결과 기록 방식 (Pass / Fail 구분)

테스트 결과는 TestRail 등에 기록할 때, **Pass**인 경우와 **Fail**인 경우를 구분하고, Fail은 **이유별로** 구분해서 기록한다.

### Pass일 때

- TestRail 코멘트에 **검증 통과한 내용**을 적는다.
- `[통과한 필드]`라는 제목 아래, 검증에 통과한 필드명과 그 값을 목록으로 적는다. (어떤 필드가 기대값과 일치했는지 추적 가능하도록.)

### Fail일 때 — 이유 구분

| 구분 | 표시 방식 | 설명 |
|------|-----------|------|
| **프론트 실패** | `[프론트 실패 사유]` + 메시지 | 페이지 이동 실패, 검색 실패, 모듈 미노출, 상품 클릭 실패 등 **UI/동작 단계**에서 실패한 경우. 메시지로 구체적인 사유를 적는다. |
| **값 정합성 실패** | `[필드값 정합성 오류]` + 불일치 내용 | 이벤트 로그는 수집되었으나, **기대값과 실제값이 다른** 필드가 있는 경우. 어떤 필드가 어떤 기대값/실제값인지 적는다. 가능하면 같은 코멘트에 `[통과한 필드]` 목록도 포함해, 일부만 실패했음을 구분할 수 있게 한다. |
| **이벤트 미수집** | `[이벤트 수집 오류]` 또는 `[프론트 실패 사유]` | 해당 이벤트 로그가 아예 수집되지 않은 경우. 프론트 실패로 인한 것이면 `[프론트 실패 사유]`로 구분한다. |

---

## 5. 진행 영역

어떤 페이지(영역)를 대상으로 검증하는지와, 테스트런 결과를 어떻게 확인하는지 정리한다.

| 영역 | 설명 |
|------|------|
| **LP** | 카테고리 기반 리스트 페이지. 모듈별 상품 클릭 시 트래킹 로그 정합성 검증. (lp_tracking.feature) |
| **SRP** | 검색 결과 페이지. 검색어·모듈별 상품 클릭 시 트래킹 로그 정합성 검증. (srp_tracking.feature) |
| **CART** | 장바구니 페이지. 장바구니 모듈 내 상품 클릭 등 트래킹 검증. (cart_tracking.feature) |
| **주문완료** | 주문완료 페이지. 주문완료 모듈 내 상품/옵션선택 클릭 시 트래킹 검증. (order_complete_tracking.feature) |
| **PDP 관련** | 상품 상세 페이지 관련 스텝·검증은 있으나, 전용 Feature 시나리오는 아직 없음. 향후 PDP 전용 시나리오 추가 예정. |

### 테스트런 결과 URL

테스트 실행 후 생성되는 **TestRail 테스트런 결과 URL**을 아래에 적어 두면, 해당 URL만으로 **작업이 어떻게 진행되었는지**(통과/실패·스킵·코멘트)를 바로 확인할 수 있습니다. 실행이 끝날 때마다 URL을 갱신해 두세요.

| 실행 일시(또는 Run 명) | 테스트런 결과 URL |
|------------------------|-------------------|
| (예: 2025-01-28 SRP 전체) | |
| | |
| | |

---

## 6. 필드 관리 (구글 시트, 공통 필드)

- **각 필드 구글 시트로 관리**: 검증에 사용하는 필드(경로·필드명·기대값 등)는 **영역별 구글 시트**(SRP, LP, CART, ORDER)에서 관리한다. 시트에는 모듈명, 이벤트 타입, 경로, 필드명, 값 형태로 행을 넣어 관리한다.
- **일일이 관리하기 부담**이 있어, **공통 필드 분리**로 여러 이벤트에서 공통으로 쓰는 필드는 한곳에 정의해 두고, 시트·JSON 변환 시 반영하는 방향으로 개선 중이며, 추후 업데이트 예정이다.
- **공통 필드**: 이벤트별로 “공통으로 쓰는 필드” 목록을 정의해 두고, 시트에서 JSON으로, JSON에서 시트로 변환할 때 이 정의를 반영한다. 이를 통해 필드 추가·수정 시 중복 작업을 줄인다.
